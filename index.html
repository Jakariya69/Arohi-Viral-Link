<div id="profile-page" class="sub-page">
    <div class="bg-white p-6 rounded-[35px] shadow-sm border border-gray-100">
        <h2 class="text-xl font-black text-gray-800 mb-6 flex items-center gap-2">
            <i data-lucide="wallet" class="text-indigo-600"></i> Withdraw Money
        </h2>
        
        <div class="space-y-5">
            <div class="grid grid-cols-2 gap-4">
                <button onclick="selectMethod('Bkash', this)" id="b-btn" class="method-card p-4 border-2 border-gray-100 rounded-[25px] flex flex-col items-center gap-2 transition-all">
                    <img src="https://admin.f-pay.app/p_logo/bkash.png" class="w-10 h-10 object-contain">
                    <span class="text-xs font-black text-gray-700">Bkash</span>
                </button>
                <button onclick="selectMethod('Nagad', this)" id="n-btn" class="method-card p-4 border-2 border-gray-100 rounded-[25px] flex flex-col items-center gap-2 transition-all">
                    <img src="https://freepnglogo.com/images/all_img/1701524320nagad-logo-png.png" class="w-10 h-10 object-contain">
                    <span class="text-xs font-black text-gray-700">Nagad</span>
                </button>
            </div>

            <div class="space-y-3">
                <div class="relative">
                    <input id="w-number" type="number" placeholder="Enter Account Number" class="w-full p-4 pl-12 bg-gray-50 rounded-2xl outline-none border border-gray-100 font-bold text-sm focus:border-indigo-500 transition-all">
                    <i data-lucide="phone" class="w-4 h-4 absolute left-4 top-4.5 text-gray-400"></i>
                </div>
                <div class="relative">
                    <input id="w-amount" type="number" placeholder="Enter Amount (Min. ৳100)" class="w-full p-4 pl-12 bg-gray-50 rounded-2xl outline-none border border-gray-100 font-bold text-sm focus:border-indigo-500 transition-all">
                    <i data-lucide="banknote" class="w-4 h-4 absolute left-4 top-4.5 text-gray-400"></i>
                </div>
            </div>

            <button onclick="submitWithdraw()" class="w-full bg-[#1a1c1e] text-white py-5 rounded-[25px] font-black text-sm shadow-xl flex items-center justify-center gap-3 active:scale-95 transition-transform">
                Send Request <i data-lucide="send" class="w-4 h-4"></i>
            </button>
        </div>
    </div>
</div>

<style>
    .method-active { border-color: #5f33e1 !important; background: #f5f3ff !important; }
</style>

<script>
    let currentMethod = "";

    function selectMethod(method, el) {
        currentMethod = method;
        document.querySelectorAll('.method-card').forEach(c => c.classList.remove('method-active'));
        el.classList.add('method-active');
    }

    async function submitWithdraw() {
        const num = document.getElementById('w-number').value;
        const amt = document.getElementById('w-amount').value;
        const uName = document.getElementById('user-name').innerText;

        if(!currentMethod) return alert("Please select Bkash or Nagad!");
        if(num.length < 11) return alert("Enter valid number!");
        if(amt < 100) return alert("Minimum withdrawal ৳100");
        if(amt > balance) return alert("Insufficient balance!");

        // Firebase-এ রিকোয়েস্ট সেভ করা
        await db.collection('withdrawals').add({
            name: uName,
            method: currentMethod,
            number: num,
            amount: parseFloat(amt),
            status: "Pending",
            time: Date.now()
        });

        balance -= parseFloat(amt);
        updateBalance();
        alert("Withdrawal request sent successfully! Wait 24h.");
        document.getElementById('w-number').value = "";
        document.getElementById('w-amount').value = "";
    }
</script>
