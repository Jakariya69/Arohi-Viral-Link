<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Arohi Mim Link</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="max-w-2xl mx-auto p-6 bg-gray-100">

    <div class="flex items-center justify-between mb-8">
        <h1 class="text-2xl font-bold">Admin Dashboard</h1>
        <a href="index.html" class="text-blue-600 font-bold">Back to App</a>
    </div>

    <div class="bg-white p-6 rounded-2xl shadow-md mb-8">
        <h2 class="text-lg font-bold mb-4">Add New Video</h2>
        <div class="space-y-4">
            <input id="ep-title" type="text" placeholder="Video Title" class="w-full p-3 border rounded-xl">
            <input id="ep-thumb" type="text" placeholder="Thumbnail URL" class="w-full p-3 border rounded-xl">
            <input id="ep-url" type="text" placeholder="Video URL" class="w-full p-3 border rounded-xl">
            <button onclick="addEpisode()" class="w-full bg-black text-white py-4 rounded-xl font-bold">Upload</button>
        </div>
    </div>

    <div class="bg-white p-6 rounded-2xl shadow-md">
        <h2 class="text-lg font-bold mb-4">Delete Videos</h2>
        <div id="admin-episode-list" class="space-y-4">Loading...</div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCpNJm6i8cH6GNI5j2XQAiUgU7q-97c150",
            projectId: "mini-app-link",
            appId: "1:608662003617:web:681a069935bc118d5bb5e0"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        async function loadEpisodesAdmin() {
            const container = document.getElementById('admin-episode-list');
            const snapshot = await db.collection('episodes').orderBy('order', 'desc').get();
            container.innerHTML = '';
            snapshot.forEach(doc => {
                const ep = doc.data();
                container.innerHTML += `
                    <div class="flex items-center justify-between border-b pb-2">
                        <span class="font-bold text-sm truncate w-2/3">${ep.title}</span>
                        <button onclick="deleteEpisode('${doc.id}')" class="text-red-500 p-2">
                            <i data-lucide="trash-2"></i>
                        </button>
                    </div>`;
            });
            lucide.createIcons();
        }

        async function addEpisode() {
            const title = document.getElementById('ep-title').value;
            const thumb = document.getElementById('ep-thumb').value;
            const url = document.getElementById('ep-url').value;
            if(!title || !thumb || !url) return alert("Fill all fields!");
            await db.collection('episodes').add({ title, thumb, url, order: Date.now() });
            alert("Added!");
            location.reload();
        }

        async function deleteEpisode(id) {
            if (confirm("Delete this video?")) {
                await db.collection('episodes').doc(id).delete();
                alert("Deleted!");
                loadEpisodesAdmin();
            }
        }
        window.onload = loadEpisodesAdmin;
    </script>
</body>
</html>
